# 3.8.1 Обзор SMACH

Мы предполагаем, что вы проработали, по крайней мере, некоторые из учебников по [SMACH Wiki](http://wiki.ros.org/smach/Tutorials), так что мы предоставим здесь только обзор основных концепций. Если вам нужна более подробная информация о данном классе или функции, вы можете посмотреть её в [API SMACH](http://docs.ros.org/jade/api/smach/html/index.html). Вы также можете перейти непосредственно к исходным текстам на GitHub.

SMACH состояния - это Python классы, которые расширяют класс smach.State, переопределяя метод execute\(\) для возврата одного или нескольких возможных результатов. Метод execute также может принимать необязательный аргумент, определяющий коллекцию пользовательских данных, которая может быть использована для передачи информации между состояниями. Реальные вычисления, выполняемые состоянием, могут быть, по сути, всем, чем угодно, но существует ряд предопределенных типов состояний, которые могут сэкономить много ненужного кода. В частности, класс [SimpleActionState](http://wiki.ros.org/smach/Tutorials/SimpleActionState) превращает обычное ROS действие в SMACH состояние. Аналогично, [MonitorState](http://wiki.ros.org/smach/Tutorials/MonitorState) обёртывает тему ROS, а [ServiceState](http://wiki.ros.org/smach/Tutorials/ServiceState) обрабатывает сервисы ROS.[ CBState](http://wiki.ros.org/smach/Tutorials/CBState) использует декоратор _@smach.cb\_interface_ , чтобы превратить практически любую понравившуюся функцию в SMACH-состояние.

Машина состояния SMACH - это другой класс Python \(smach.StateMachine\), который может содержать несколько состояний. Состояние добавляется в машину состояний путем определения набора переходов из результатов состояния в другие состояния в машине. Когда машина состояний запущена, эти переходы определяют поток выполнения из состояния в состояние:

_input → STATE\_1 → {outcome, transition} → STATE\_2_

 _input → STATE\_2 → {outcome, transition} → STATE\_3_ 

и т.д.

Сама по себе машина состояния должна иметь результат и, следовательно, может быть состоянием в другой машине состояния. Таким образом, машины состояния могут быть вложены в иерархию. Например, машина состояния, называемая "чистый дом", может содержать вложенные машины состояний "пылесос", "кухня-швабра", "умывальник" и так далее. Машина состояния "Чистый дом" более высокого уровня будет определять, как результаты вложенных машин состояния будут соотноситься с общим результатом \(например, "все задания завершены" или "не все задания завершены"\).

Существует ряд предопределенных контейнеров SMACH, которые также могут сэкономить вам много времени при программировании. [Контейнер согласованности](http://wiki.ros.org/smach/Tutorials/Concurrence%20container) возвращает результат, который зависит от нескольких состояний и позволяет одному состоянию упредить другое. [Контейнер последовательности](http://wiki.ros.org/smach/Tutorials/Sequence%20container) автоматически генерирует последовательные переходы между состояниями, которые к нему добавляются. А [контейнер итератор](http://wiki.ros.org/smach/Tutorials/Iterator%20container) позволяет прохождение через одно или несколько состояний до тех пор, пока не будет выполнено какое-либо условие. Мы узнаем больше об этих контейнерах по мере необходимости.



