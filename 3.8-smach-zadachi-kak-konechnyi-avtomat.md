# 3.8 SMACH: Задачи как машины состояний

Перед началом работы с SMACH убедитесь, что у вас установлены необходимые ROS-пакеты:

```text
$ sudo apt-get install ros-indigo-smach ros-indigo-smach-ros \ ros-
indigo-executive-smach ros-indigo-smach-viewer
```

В некоторых наших примерах мы также будем использовать простой GUI-пакет под названием _python-easygui_ , так что давайте установим его сейчас:

```text
$ sudo apt-get install python-easygui
```

SMACH позволяет программировать последовательность действий с помощью машин конечного состояния. Как следует из названия, машина состояния может находиться в одном из нескольких состояний в любой момент времени. Машина также принимает входы, и в зависимости от значения входов и текущего состояния машина может перейти в другое состояние. В результате такого перехода машина состояния также может дать результат. Машины конечного состояния также называются автоматами или реактивными системами, так как нам нужно знать только текущее состояние машины и ее входа \(входов\), чтобы предсказать ее следующее действие.

Один из простейших реальных примеров машины состояния - замок и ключ. Блокировка может быть в одном из двух состояний, ЗАБЛОКИРОВАННОЕ или НЕЗАБЛОКИРОВАННОЕ при повороте ключа по часовой стрелке или против часовой стрелки - это вход. \(По условию, имена состояний записываются во всех верхних регистрах.\) Возможны переходы от БЛОКИРОВКИ к НЕБЛОКИРОВКЕ и от НЕБЛОКИРОВКИ к БЛОКИРОВКЕ в зависимости от направления вращения ключа. \(Для полноты можно также указать переходы ЗАБЛОКИРОВАННОЕ в ЗАБЛОКИРОВАННОЕ и НЕЗАБЛОКИРОВАННОЕ в НЕЗАБЛОКИРОВАННОЕ\). В результате дверь может быть открыта или не может быть открыта.

Пакет [SMACH](http://wiki.ros.org/smach) предоставляет автономную библиотеку Python для создания машин состояния и ROS-обертку для интеграции библиотеки с ROS-темами, сервисами и действиями. Вики-страницы SMACH включают в себя ряд отличных [учебников](http://wiki.ros.org/smach/Tutorials), и читателю рекомендуется проработать как можно больше из них. По крайней мере, важно понимать страницу ["Начало работы"](http://wiki.ros.org/smach/Tutorials/Getting%20Started). Мы будем предполагать некоторое знакомство с этими учебниками по мере того, как мы будем просматривать наши примеры.

SMACH имеет множество функций и может показаться немного перегруженным на первый взгляд. Поэтому мы возьмем каждый компонент по очереди, используя примеры, которые дают визуальную обратную связь. Но сначала краткий обзор того, что вы узнали из онлайн-тренингов.

